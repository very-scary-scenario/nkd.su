{% extends parent %}

{% block title %}{{ object.username }}{% endblock %}

{% block main_classes %}
  profile
{% endblock %}

{% block content %}
  {% if object.profile.avatar %}
    <img class="avatar" src="{{ object.profile.get_avatar_url }}"></img>
  {% endif %}

  <h1>{{ object.username }}</h1>

  {% if object == request.user %}
    {% if object.profile.twitter_user %}
      <p>
        your account has adopted historical requests from twitter user @{{ object.profile.twitter_user.screen_name }}
      </p>
    {% endif %}

    {% if object.social_auth.all %}
      {% for social_auth in object.social_auth.all %}
        <p>
          your account currently allows authentication via a
          <code>{{ social_auth.provider }}</code> user named
          <strong>{{ social_auth.extra_data.access_token.screen_name }}</strong>
        </p>
        {% if social_auth.provider == "twitter" %}
          <p>
            {# XXX make sure this password change link works for users that have never set a password #}
            we'd prefer not to trust twitter any more than we have to, so please <a href="{% url "password_change" %}">make sure you know your nkd.su password</a> and then <a href="{% url "social:disconnect" backend="twitter" %}">disconnect your account from twitter</a>
          </p>
          <p>
            disconnecting your account like this will not remove your adopted requests from @{{ object.profile.twitter_user.screen_name }}
          </p>
        {% endif %}
      {% endfor %}
    {% else %}
      {% if not object.profile.twitter_user %}
        <p><a href="{% url "social:begin" backend="twitter" %}">link twitter account</a></p>
      {% endif %}
    {% endif %}
  {% endif %}

  {% if object == request.user %}
    <p><a href="{% url "vote:profiles:edit-profile" %}">edit your profile</a></p>
  {% endif %}
{% endblock %}
